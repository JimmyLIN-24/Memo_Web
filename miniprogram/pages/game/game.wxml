<!--pages/game/game.wxml-->
<view class="container">
  <view class="header">
    <view class="title">ğŸ® è®°å¿†ç¿»ç‰Œ</view>
    <view wx:if="{{isPlaying}}" class="status">
      <text>åŒ¹é…: {{matchedPairs}}/{{currentLevel.pairs}}</text>
      <view class="btn-group">
        <button class="btn-mini" bindtap="restart">ğŸ”„</button>
        <button class="btn-mini" bindtap="backToLevels">â¬…ï¸</button>
      </view>
    </view>
  </view>

  <!-- Level Selection -->
  <view class="level-select" wx:if="{{!isPlaying}}">
    <view class="level-grid">
      <view 
        class="level-card {{unlockedLevels.indexOf(item.id) !== -1 ? 'unlocked' : 'locked'}}" 
        wx:for="{{levels}}" 
        wx:key="id"
        bindtap="selectLevel"
        data-id="{{item.id}}"
      >
        <view class="level-num">{{item.name}}</view>
        <view class="level-size">{{item.label}}</view>
        <view class="lock-icon">{{unlockedLevels.indexOf(item.id) !== -1 ? 'ğŸ”“' : 'ğŸ”’'}}</view>
      </view>
    </view>
  </view>

  <!-- Game Board -->
  <view class="game-board" wx:if="{{isPlaying}}">
    <view class="cards-grid grid-{{currentLevel.size}}">
      <view 
        class="card {{item.flipped || item.matched ? 'flipped' : ''}} {{item.matched ? 'matched' : ''}}" 
        wx:for="{{cards}}" 
        wx:key="id"
        bindtap="onCardTap"
        data-index="{{index}}"
      >
        <view class="card-face card-front">{{item.content}}</view>
        <view class="card-face card-back">â“</view>
      </view>
    </view>
  </view>

  <!-- Win Modal -->
  <view class="win-overlay" wx:if="{{showWin}}">
    <view class="win-content">
      <view class="win-title">æ­å–œé€šå…³ï¼ğŸ‰</view>
      <view class="win-stars">â­â­â­</view>
      <view class="win-actions">
        <button class="btn btn-primary" bindtap="nextLevel">ä¸‹ä¸€å…³</button>
        <button class="btn btn-secondary" bindtap="backToLevels">è¿”å›å…³å¡</button>
      </view>
    </view>
  </view>
</view>

